# docker-compose -f production.yml

version: '2'

services:
    nginx:
      build:
        context: nginx
        dockerfile: Dockerfile
      restart: always
      depends_on:
        - web
      ports:
        - "80:80"

    web:
      extends:
        file: docker-compose.common.yml
        service: web
      restart: always

    db:
      extends:
        file: docker-compose.common.yml
        service: db
      volumes:
        - mongo-data:/data/db
      restart: always

    mornitor:
      build: .
      command: ./mornitor.py
      restart: always
      environment:
        - MONGO_URL=mongodb://db:27017

volumes:
  mongo-data:
    driver: local
